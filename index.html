<!DOCTYPE html>
<!--
 * HTML-Sheets-of-Paper (https://github.com/delight-im/HTML-Sheets-of-Paper)
 * Copyright (c) delight.im (https://www.delight.im/)
 * Licensed under the MIT License (https://opensource.org/licenses/MIT)
-->
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="description" content="Emulating real sheets of paper in web documents (using HTML and CSS)">
		<title>Sheets of Paper</title>
		<link rel="stylesheet" type="text/css" href="css/sheets-of-paper-a4-landscape.css">
    <style>
      .page {
      }
      .row {
        margin: 0.5cm 0;
        display: flex;
        flex-direction: row;
        align-items: stretch;
        justify-content: space-between;
      }
      .cell {
        display: inline-block;
        width: 50%;
        height: 8.75cm;
        border: 1px solid black;
        padding: 0.2cm;
        margin: 0cm 0.2cm;
        overflow: hidden;
      }
    </style>
	</head>
	<body>
    <template id='pageTemplate'>
      <div class="page">
        <div class="row">
          <div class="cell" contenteditable="true">
          </div>
          <div class="cell" contenteditable="true">
          </div>
        </div>
        <div class="row">
          <div class="cell" contenteditable="true">
          </div>
          <div class="cell" contenteditable="true">
          </div>
        </div>
      </div>
    </template>
    <div class="action">
      <button id='btnPreview' onclick="preview()">preview</button>
      <button id='btnBack' onclick="restore()">back</button>
    </div>
    <div id="document">
    </div>
		<script type="text/javascript">
      const btnPreview = document.getElementById('btnPreview');
      const btnBack = document.getElementById('btnBack');
      btnBack.style.display = 'none';
      let originCells = [];
      let printCells = [];
      let doc = document.getElementById('document');
      let template = document.getElementById('pageTemplate');
      sample();
      function sample() {
        originCells = ['1', '2', '3', '4', '5', '6', '7'];
        applyCells(originCells);
      }
      function preview() {
        originCells = [...document.querySelectorAll('.cell')].map(c=>c.innerText).filter(c=>c.replace(/(\r\n|\n|\r)/gm,"")!=='');
        printCells = rearrangeForPrint(originCells);
        applyCells(printCells);
        btnPreview.style.display = 'none';
        btnBack.style.display = 'inline';
      }
      function restore() {
        originCells = rearranageFromPrint(printCells);
        applyCells(originCells);
        btnPreview.style.display = 'inline';
        btnBack.style.display = 'none';
      }
      function rearrangeForPrint(cells) {
        return cells;
      }
      function rearranageFromPrint(cells) {
        return cells;
      }
      function applyCells(cells) {
        doc.innerHTML = '';
        for(let i=0;i<cells.length;i+=4) {
          const p = getPage();
          p.querySelectorAll('.cell').forEach((c,j)=>{
            c.innerText = cells[i+j] || '';
          });
          doc.appendChild(p);
        }
      }
      function getPage() {
        return template.content.cloneNode(true);
      }
		</script>
	</body>
</html>

